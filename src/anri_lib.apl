.head 0 +  Application Description: 

Anri_LIB ver. 1.0
(c) 06/07/2005
.head 1 -  Outline Version - 4.0.34
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000D00000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  File Include: a_find_tbl.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 -  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 -  System
.head 3 +  User
.head 4 -  Number: START_CONST	= 200
.head 4 -  Number: AAM_EDITFLAG	= SAM_User + START_CONST + 1
.head 4 -  Number: AAM_DELETE	= SAM_User + START_CONST + 2
.head 4 -  Number: AAM_COPY		= SAM_User + START_CONST + 3
.head 4 -  Number: AAM_SQL_ERROR	= SAM_User + START_CONST + 4
.head 4 -  Number: MY_Initialize	= SAM_User + START_CONST + 5
.head 4 -  Number: AAM_Refresh	= SAM_User + START_CONST + 6
.head 4 -  Number: AAM_SAVE		= SAM_User + START_CONST + 7
.head 4 -  Number: AAM_MENU	= SAM_User + START_CONST + 8
.head 4 -  Number: AAM_POPULATE_ROW= SAM_User + START_CONST + 9
.head 4 -  Number: AAM_FOCUS	= SAM_User + START_CONST + 10
.head 4 -  Number: AAM_IS_SAVED	= SAM_User + START_CONST + 11
.head 4 -  Number: AAM_CreateComplete	= SAM_User + START_CONST + 12
.head 4 -  Number: AAM_ANALITIKA	= SAM_User + START_CONST + 13
.head 4 -  Number: AAM_GET_TYPE_WIN= SAM_User + START_CONST + 14
.head 4 -  Number: AAM_TIMER	= SAM_User + START_CONST + 15
.head 4 -  Number: AAM_LOAD 	= SAM_User + START_CONST + 16
.head 4 -  Number: AAM_RECALC 	= SAM_User + START_CONST + 17
.head 4 -  Number: AAM_PASTE 	= SAM_User + START_CONST + 18
.head 4 -  Number: AAM_OPEN 	= SAM_User + START_CONST + 19
.head 4 -  Number: AAM_PRINT 	= SAM_User + START_CONST + 20
.head 4 -  !
.head 4 -  String: APPLICATION_NAME	= 'FINANCE'
.head 4 -  String: COMPANY_NAME	= 'FINKRASKA'
.head 4 -  !
.head 4 -  Number: TBL_Split_NoAdjustable	= FALSE
.head 3 -  Enumerations
.head 2 +  Resources
.head 3 +  Bitmap: resOpen
.head 4 -  File Name: Bkopen.bmp
.head 3 +  Bitmap: resClose
.head 4 -  File Name: Bkclosed.bmp
.head 2 +  Variables
.data RESOURCE 0 0 1 2220761292
0000: E4020000EC010000 0000000000000000 02000018000000CD 0F00000004000000
0020: 0102B601F02F0000 001F800100FC0000 23D10F0019000400 0001B60130003C00
0040: 007300D000000100 0068EA0F00040001 03B6010B0A00006E 007300360100EE0F
0060: 1A0004000102A343 0A00004F0F0000F4 010000860F00F20F 0096190001B6E844
0080: 0A00004673000100 00830B1000000425 0002B6450ABA0000 73D9000100680F10
00A0: 0004008D02460A00 6E00730036010013 105A00190001A2B6 6C0A00001B730001
00C0: 008D002C1000D604 0002E86D0A000066 73000100A3301000 19250001B67F0ABA
00E0: 000073D100010000 6849100004008D02 800A006E00730036 01004D105A001900
0100: 0182B6F212000000 1B730001008D0066 100096190001B6E0 A613000000467300
0120: 010000A37F100004 350002A713BA0000 73D9000100688310 0019000901B64114
0140: 00006E0073003401 00009C105A001900 0182B61F1E000000 1B730001008D00B5
0160: 100096190001B6E8 A31E000046730001 0000A3CE10001925 0001B6A41EBA0000
0180: 73D10001000068E7 100019008901B6A5 1E006E0073007401 0000115800001900
01A0: 01A2B6A61E00001B 730001008D001911 0095000001B6E8A7 1E00004673000100
01C0: 00A3321100192500 01B68323B8000000 73D100010000684B 110004008903B684
01E0: 23006E0073003601 004F115A00190001 82B605280000001B 730001000D00
.enddata
.head 3 -  FunctionalVar: fcRegistryVar
.head 4 -  Class: fcRegistry
.head 3 -  ! String: APPLICATION_NAME	!	= 'FINANCE'
.head 3 -  ! String: COMPANY_NAME	!	= 'FINKRASKA'
.head 3 -  Boolean: gbExcel
.head 2 +  Internal Functions
.head 3 +  Function: fWaitCursor
.head 4 -  Description: Показать или спрятать курсор в виде часов
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nCursorState
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SalWaitCursor( nCursorState )
.head 5 -  Call VisWaitCursor( nCursorState )
.head 3 +  Function: fsTranslateText
.head 4 -  Description: Перевод текста
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sText
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return sText
.head 3 +  Function: fbShowWindow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: bShow
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bShowOld
.head 4 +  Actions
.head 5 -  Set bShowOld = SalIsWindowVisible ( hWnd )
.head 5 +  If bShowOld != bShow
.head 6 +  If bShow
.head 7 -  Call SalShowWindow ( hWnd )
.head 6 +  Else
.head 7 -  Call SalHideWindow ( hWnd )
.head 5 -  Return bShowOld
.head 3 +  Function: fbWhenSqlError
.head 4 -  Description: Глобальная обработка SQL-ошибок
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: bShow
.head 4 +  Static Variables
.head 5 -  String: sErrorText [ * ]
.head 5 -  Number: nErrorText
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nErr
.head 5 -  Number: nPos
.head 5 -  Number: nLenReason
.head 5 -  Number: nLenRemedy
.head 5 -  ! String: strNum
.head 5 -  ! String: strErrmsg
.head 5 -  ! String: strErrorReason
.head 5 -  ! String: strErrorRemedy
.head 5 -  Boolean: bOk
.head 5 -  Boolean: bRollback
.head 5 -  String: strNum
.head 5 -  String: strErrmsg
.head 5 -  String: strErrorReason
.head 5 -  String: strErrorRemedy
.head 5 -  String: sSqlStatement
.head 5 -  String: sError
.head 5 -  String: sPlan
.head 5 -  Number: nPosSQL
.head 5 -  Number: nLen
.head 4 +  Actions
.head 5 +  If bShow
.head 6 +  If nErrorText > 0
.head 7 -  Set nErrorText = nErrorText - 1
.head 6 -  Call fnMessageBox( sErrorText [ nErrorText ], 'Database Error', MB_Ok )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! If processing gets to here on a SQL error, there is
.head 6 -  ! little to do except report the error and gracefully quit
.head 6 -  !
.head 6 -  Call SqlExtractArgs( wParam, lParam, hSqlError, nErr, nPos )
.head 6 +  If nErr < 0
.head 7 -  Set nErr = - nErr
.head 7 -  Set bRollback = TRUE
.head 6 +  If nErr != 203
.head 7 -  Set sSqlStatement = SqlGetLastStatement ( )
.head 7 -  ! Call VisStrSubstitute( sSqlStatement, 'COD', 'cOd' )
.head 7 -  ! Call VisStrSubstitute( sSqlStatement, ',', '^^' )
.head 7 +  If SqlIsConnected ( hSqlError )
.head 8 -  Call SqlGetErrorPosition ( hSqlError, nPosSQL )
.head 8 +  If nPosSQL > 0
.head 9 -  Set nLen = SalStrLength( sSqlStatement )
.head 9 +  If nPosSQL <= nLen
.head 10 -  Set sSqlStatement = SalStrLeftX( sSqlStatement, nPosSQL ) || "***" ||
SalStrRightX( sSqlStatement, nLen - nPosSQL )
.head 7 -  Set sSqlStatement = VisStrSubstitute( sSqlStatement, '  ', ' ' )
.head 7 -  Set sSqlStatement = VisStrSubstitute( sSqlStatement, ' ,', ',' )
.head 7 -  Set sSqlStatement = VisStrSubstitute( sSqlStatement, '
,', ',' )
.head 7 -  ! Call SqlExecutionPlan ( hSqlError, sPlan, 1024 )
.head 7 -  ! bOk = SqlGetError( hSql, nError, strErrorString )
.head 7 -  ! bOk = SqlErrorText ( nError, nType, strError, nLength, nRealLength )
.head 7 -  ! nError = SqlError ( hSql )
.head 7 -  Call SqlGetErrorText( nErr, strErrmsg )
.head 7 -  Set strErrmsg = strErrmsg || ' (' || SalNumberToStrX( nPos, 0 ) || ')'
.head 7 -  Set bOk = SqlErrorText ( nErr, SQLERROR_Reason, strErrorReason, 32000, nLenReason )
.head 7 +  If nErr = 401
.head 8 -  Set strErrorRemedy = ''
.head 7 +  Else
.head 8 -  Set bOk = SqlErrorText ( nErr, SQLERROR_Remedy, strErrorRemedy, 32000, nLenRemedy )
.head 7 -  Call SalNumberToStr( nErr, 0, strNum )
.head 7 +  If bRollback
.head 8 -  Set strNum = strNum || ' (Rollback)'
.head 7 -  Set sError = '      ' || strNum || ' - ' || strErrmsg || '

' || strErrorReason || '

Statement (' || SalNumberToStrX( nPosSQL, 0 ) || '): ' || sSqlStatement
.head 7 +  If hWndMDI = hWndNULL
.head 8 -  ! Call SalPostMsg( hWndForm, Number, Number, Number )
.head 8 -  Call fnMessageBox(sError, 'Database Error', MB_Ok )
.head 7 +  Else
.head 8 -  Set sErrorText [ nErrorText ] =  sError
.head 8 -  Set nErrorText = nErrorText + 1
.head 8 -  Call SalPostMsg( hWndMDI, AAM_SQL_ERROR, nErr, lParam )
.head 6 -  !
.head 6 -  ! The Return statement tells Centura **not** to invoke
.head 6 -  ! default error processing
.head 6 -  !
.head 6 -  Return FALSE
.head 3 +  Function: fnMessageBox
.head 4 -  Description: Показать диалог с сообщением или вопросом
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: strText
.head 5 -  String: strTitle
.head 5 -  Number: nFlags
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nResult
.head 4 +  Actions
.head 5 -  Set nResult = SalMessageBox (  strText, strTitle, nFlags )
.head 5 -  Return nResult
.head 3 +  Function: SalTblGetColumnTextX
.head 4 -  Description: Function returns text of a column by its position
	Parameters:	- window handle	handle of table window
			- number		position of a column
	Returns:		- string		contents of a given column
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndPrm
.head 5 -  Number: nPosPrm
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strRet
.head 4 +  Actions
.head 5 -  Call SalTblGetColumnText ( hWndPrm, nPosPrm, strRet )
.head 5 -  Return strRet
.head 3 +  Function: SalTblGetColumnTitleX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndCol
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sBuffer
.head 4 +  Actions
.head 5 -  Call SalTblGetColumnTitle ( hWndCol, sBuffer, 255)
.head 5 -  Return sBuffer
.head 3 +  Function: SalNumberRoundX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nNumber
.head 5 -  Number: nDot
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nResult
.head 5 -  Number: n
.head 4 +  Actions
.head 5 -  Set n = 1
.head 5 +  While nDot > 0
.head 6 -  Set n = n * 10
.head 6 -  Set nDot = nDot - 1
.head 5 -  Set nResult = SalNumberRound ( nNumber * n ) / n
.head 5 -  Return nResult
.head 3 +  Function: fGetNextDate
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Date/Time: dDate
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nYear
.head 5 -  Number: nMonth
.head 5 -  Number: nDay
.head 5 -  Number: nAdd
.head 5 -  Number: nLast
.head 4 +  Actions
.head 5 +  If dDate = DATETIME_Null
.head 6 -  Return DATETIME_Null
.head 5 -  Set nAdd = 1
.head 5 -  Set nYear = SalDateYear(dDate)
.head 5 -  Set nMonth = SalDateMonth(dDate)
.head 5 -  Set nDay = SalDateDay(dDate)
.head 5 -  Set nDay = nDay + nAdd
.head 5 -  Set nLast =  SalDateDay(SalDateMonthEnd( dDate ) )
.head 5 +  If nDay > nLast
.head 6 -  Set nDay = nDay - nLast
.head 6 +  If nMonth = 12
.head 7 -  Set nMonth = 1
.head 7 -  Set nYear = nYear + 1
.head 6 +  Else
.head 7 -  Set nMonth = nMonth + 1
.head 5 -  Return SalDateConstruct(nYear, nMonth, nDay, SalDateHour(dDate), SalDateMinute(dDate), SalDateSecond(dDate))
.head 3 +  Function: fGetAppName
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDrive
.head 5 -  String: sDir
.head 5 -  String: sFile
.head 5 -  String: sExt
.head 4 +  Actions
.head 5 -  Call VisDosSplitPath ( strArgArray[0], sDrive, sDir, sFile, sExt )
.head 5 -  Return sFile
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 4027371873
0000: F60D00002C090000 0000000000000000 0200001500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F32003C00 000C67007763536F
0040: 7274546100626C65 4000000002780000 00190800000001B4 010A780000007380
0060: 00000001000000CD 190019120001B42A 0000DE0073680001 0000018880320000
0080: 010010000E677743 6F6E007665727443 6861726440000002 006F19000901B405
00A0: 0000004354027300 00B4010000195900 190001C2B4060000 001E540001000D00
00C0: 0180210018000002 000A660863526569 73747200795E0000 000300001E000400
00E0: 00C20002B40105C6 009C027368000100 0004B3000400B602 06003D9C00011B00
0100: 0800002C00190001 B461070000009C8F 0001008600018019 000C0003000D6777
0120: 0153697A65446961 006C6F6722000000 017A0000194B0001 B4051B00A80273A3
0140: 0001000031018019 0004030009635669 6580774469637422 00E8000100002D19
0160: 0001B46110000000 F08C0273000100C6 0001803208000500 0011634700656E65
0180: 72616C5769406E52 6573697A40A30002 0000B71900B401B4 050021B60C730000
01A0: 01DA0000192C0019 0001B46D0600B68F 0001000600018036 0000080006000018
01C0: 6347FF09436F7465 7874005365617263 685E00D90003005B 190001DAB4050018
01E0: C20C730001006D00 190096190001B4B6 0600C24700010000 9332000004A50002
0200: B407ED00C2D90001 000001801D000000 07000900116F6C43 4F004E544558545F
0220: 5345404152434840 0000F40200009604 0002B4360500E60C 4673000100009B04
0240: 0019A50001B406ED 00E6D10001000098 01801D000801000A 6342696742007574
0260: 746F6E480000E800 0200000D04000103 B4EC0107003F8001 F800000037040019
0280: 4B0001B4081A0000 8E0D73A200000100 00310180190009D0 00000011565F536C
02A0: 806563746F722200 E8000100002D1900 01B46D1000BE8C0D 73000100C6000180
02C0: 1908000A00001063 4F1A756C65457880 706C6F72657222D1 000100005B190001
02E0: DAB4070010540E73 000001000D000180 A60202000B000000 0B63006245786365
0300: 6C4D69206E690204 002100BD0019A500 01B4060D00020F73 00D1000100006619
0320: 0019006901B40700 7B0200B401000032 5900190001DAB408 001E020001000D00
0340: 4B00000096190001 B4B4090000024700 0100008364000000 19A50001B40AED00
0360: 02D100010000607D 00000019004901B4 0B00007B02003401 0000960058000019
0380: 0001C2B40C000000 1E020001000D00AF 00000096190001B4 B00D000000024700
03A0: 01000083C8000000 19250001B40E00EC 000002D100010000 60E1000000190009
03C0: 01B40F0000007B02 0034010000FA0058 0000190001DAB410 001E020001008D00
03E0: 13010096190001B4 B011000000024700 010000A32C010019 250001B41200EC00
0400: 0002D10001000068 45010019000901B4 130000007B020034 0100005E015A0019
0420: 0001C2B414000000 1E020001008D0077 010096190001B4B0 1500000002470001
0440: 0000A390010019A5 0001B416EC000002 D10001000068A901 0019000901B41700
0460: 00007B0200340100 00C2015A00190001 C2B4180000001E02 0001008D00DB0100
0480: 96190001B4B41900 00024700010000A3 F4010019250001B4 1A00EC000002D100
04A0: 010000680D020019 000901B41B000000 7B02003401000026 025A00190001C2B4
04C0: 1C0000001E020001 008D003F02009619 0001B4B41D000002 4700010000A35802
04E0: 0019250001B41E00 EC000002D1000100 0068710200190009 01B41F0000007B02
0500: 00340100008A021A 0019000101C2B420 0000007F80F20100 008F8E0200860400
0520: 0102B4F42100009F 8001FC0000A39202 001901000104B401 2200FD0027800100
0540: 00FF689602000400 0C010323000000FF C9800100003F9A02 5A00040003C2B424
0560: 0000001E02000100 8D009E0200D60400 03B0250000000267 000100A3A2020004
0580: 3500032600EC0000 02D9000100180180 36000C0009000B45 7865630053637269
05A0: 70746600D0000003 00001B04000102DB 05007F80F2010000 6F040096190001B4
05C0: 360600B213447300 00010000931D0000 19A50001B407ED00 B2D1000100001801
05E0: 8019000D00010009 73506F72744C496E 220000F401000096 190001B4360500D0
0600: 1346730001000003 018081000000040E 00000863416E0069 6D617465B80000EC
0620: 0006002D190001B4 6D0900F088147300 0001003600190004 4B0003B40ADA0000
0640: F0B3000100CD1D00 19D20001B40BF600 F0680001000036B2 00001900B401B40C
0660: 003DF000011A0000 4F00002C00190001 B46D0D00F08F0001 0006006800000019
0680: 4B0001B40EDA0000 F0A3000100003101 8019000F0200000F 634461740154696D
06A0: 65506963386B6572 00017A0000194B00 01B4071B00021573 A200000100006101
06C0: 801301103200000F 6573806B746F704C 697340426F784E01 000B7A000019CB00
06E0: 01B41B008E1673A2 0000010000CD1900 19D20001B408F600 8E680001000032B3
0700: 001900B401B40900 3D8E0001DA00004B 2C00190001B46D0A 008E8F0001003600
0720: 6400194B0001B40B DB008EA300010000 CD7D0019D20001B4 0CF6008E68000100
0740: 0096B200001900B4 01B40D003D8E0001 DA0000AF2C001900 01B4690E00008E8E
0760: 160001003600C800 194B0001B40FDB00 8EA300010000CDE1 0019920001B41000
0780: F6008E6800010000 FAB3001900B401B4 11003D8E00011A00 0001806422000011
07A0: 00000BC063446972 4C69077C00000004 7B00194B0001B407 1B00A01673A30001
07C0: 0000CD190019D200 01B408F600A06800 01000032B3001900 B401B409003DA000
07E0: 01DA00004B2C0019 0001B46D0A00A08F 000100860001804B 00C8001200000F03
0800: 547265654C699F5E 00E8000300002D19 0001B46D0700B28C 1673000100360019
0820: 00194B0001B408DB 00B2A300010000CD 320019D20001B409 F600B26800010000
0840: 018880AF00001300 00000C6346696C65 4C3FD600D8000007 005B190001DAB406
0860: 0018D61673000100 6D00190096190001 B4B60700D6470001 00009B320019A500
0880: 01B408ED00D6D100 010000664B001900 6901B409007BD600 B401000064590019
08A0: 0001DAB40A001ED6 0001006D007D0096 190001B4B60B00D6 47000100009B9600
08C0: 19A50001B40CED00 D6D1000100001001 807D000014000100 0D6352616469F86F
08E0: 4C69609A00000005 006F19006901B406 0043A217730000B4 0100001959001900
0900: 01DAB407001EA200 01006D0032009619 0001B4B60800A247 000100009B4B0019
0920: A50001B409ED00A2 D100010000666400 19006901B40A007B A20034010000
.enddata
.head 3 -  ! !
.head 3 -  ! ! Классы вида ca<NAME>  наследованы от бызовых классов
.head 3 -  ! ! кроме баз. классов: ActiveX, CustomControl, GeneralWindow, Functional
.head 3 -  ! !
.head 3 +  Background Text Class: caBackgroundText
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Title:
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 3 +  Check Box Class: caCheckBox
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Child Table Class: caChildTable
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcMouseWheel
.head 5 -  Class: gwcEditFlag
.head 5 -  Class: gwcSortTable
.head 5 -  Class: gwcAutoSave
.head 5 -  Class: gwcSqlWindow
.head 5 -  ! Class: gwcFindTable
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Destroy
.head 6 -  Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Destroy, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Destroy, 0, 0 )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalSendMsg( hWndItem, SAM_DoubleClick, 0, 0 )
.head 5 +  On PM_SetFont
.head 6 -  ! Параметры отображения
.head 6 -  Call SalColorSet( hWndForm, COLOR_IndexWindowText, nCOLOR_FONT)
.head 6 -  Call SalFontSet( hWndForm, strFONT, nFONT_SIZE, nFONT_ENH )
.head 5 +  On PM_COLUMN
.head 6 +  If wParam = 1
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SalModalDialog( dlgEditColumns, hWndForm, hWndItem )
.head 5 +  On WM_KEYUP
.head 6 +  If bNeedSaveLoad
.head 7 +  Select Case wParam
.head 8 +  Case VK_Delete
.head 9 -  Return FALSE
.head 8 +  Case VK_Clear
.head 9 -  Return FALSE
.head 8 +  Case VK_ScrollLock
.head 9 -  Call SalPostMsg( hWndItem, PM_COLUMN, 0, 0 )
.head 9 -  Return TRUE
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  ! Set xlExport.bZap = TRUE
.head 6 -  Call xlExport.ExportToExcel( hWndItem, SalGetWindowTextX ( hWndForm ) )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Create, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcFindTable, SAM_Create, 0, 0 )
.head 3 +  Column Class: caColumn
.head 4 -  Title:
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 255
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 5 -  ! Class: gwcStatusBar
.head 5 -  Class: gwcConvertChar
.head 5 -  Class: gwcSqlWindow
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Combo Box Class: caComboBox
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 5 -  Class: gwcSqlWindow
.head 5 -  Class: gwcDisable
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Data Field Class: caDataField
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 5 -  Class: gwcConvertChar
.head 5 -  Class: gwcDisable
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Dialog Box Class: caDialog
.head 4 -  Title:
.head 4 -  Accessories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Type of Dialog: Class Default
.head 5 -  Allow Dock to Parent? Class Default
.head 5 -  Docking Orientation: Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Absolute Screen Location? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Docking Toolbar? Class Default
.head 6 -  Toolbar Docking Orientation: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Resizable? Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 +  Derived From
.head 5 -  ! Class: gwcStatusBar
.head 5 -  Class: gwcSqlWindow
.head 5 -  Class: gwcAutoSave
.head 5 -  ! Class: gwcDialogWithSQL
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Create, wParam, lParam )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Create, wParam, lParam )
.head 6 -  ! Call SalSendClassMessageNamed( gwcDialogWithSQL, SAM_Create, wParam, lParam )
.head 5 +  On SAM_Destroy
.head 6 -  Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Destroy, wParam, lParam )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Destroy, wParam, lParam )
.head 6 -  ! Call SalSendClassMessageNamed( gwcDialogWithSQL, SAM_Destroy, wParam, lParam )
.head 3 +  Form Window Class: caFormWindow
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? Yes
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  Allow Child Docking? Class Default
.head 5 -  Docking Orientation: Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  ! Class: gwcStatusBar
.head 5 -  Class: gwcAutoSave
.head 5 -  ! Class: gwcShowWindow
.head 5 -  Class: gwcSqlWindow
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Docking Toolbar? Class Default
.head 6 -  Toolbar Docking Orientation: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Resizable? Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Destroy
.head 6 -  Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Destroy, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Destroy, 0, 0 )
.head 3 +  Frame Class: caFrame
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 3 +  Group Box Class: caGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.617"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.655"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Title:
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 3 +  Horizontal Scroll Bar Class: caHorizontalScrollBar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Line Class: caLine
.head 4 -  Coordinates
.head 5 -  Begin X: 
.head 5 -  Begin Y: 
.head 5 -  End X: 
.head 5 -  End Y: 
.head 4 -  Visible? Class Default
.head 4 -  Line Style: Class Default
.head 4 -  Line Thickness: Class Default
.head 4 -  Line Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 3 +  List Box Class: caListBox
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcMouseWheel
.head 5 -  Class: gwcSqlWindow
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  MDI Window Class: caMDIWindow
.head 4 -  Title:
.head 4 -  Display Settings
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Allow Child Docking? Class Default
.head 5 -  Docking Orientation: Class Default
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcAutoSave
.head 5 -  ! Class: gwcStatusBar
.head 5 -  Class: gwcSqlWindow
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Docking Toolbar? Class Default
.head 6 -  Toolbar Docking Orientation: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Resizable? Class Default
.head 5 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Destroy
.head 6 -  Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Destroy, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Destroy, 0, 0 )
.head 5 +  On AAM_SQL_ERROR
.head 6 -  Return fbWhenSqlError ( TRUE )
.head 3 +  Multiline Field Class: caMultilineField
.head 4 -  Data
.head 5 -  Maximum Data Length: 255
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.667"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcMouseWheel
.head 5 -  Class: gwcEditFlag
.head 5 -  Class: gwcDisable
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Option Button Class: caOptionButton
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Button Style: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Button Appearance: Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Picture Class: caPicture
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: caPushbutton
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Button Appearance: Class Default
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcTooltip
.head 5 -  Class: gwcStatusBar
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Radio Button Class: caRadioButton
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: gwcEditFlag
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Table Window Class: caTableWindow
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? Yes
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.358"
.head 6 -  Height Editable? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Class Default
.head 5 -  Allow Child Docking? Yes
.head 5 -  Docking Orientation: Top | Bottom
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  ! Class: gwcFindTable
.head 5 -  Class: gwcMouseWheel
.head 5 -  ! Class: gwcEditFlag
.head 5 -  ! Class: gwcStatusBar
.head 5 -  Class: gwcSortTable
.head 5 -  Class: gwcAutoSave
.head 5 -  ! Class: gwcShowWindow
.head 5 -  Class: gwcSqlWindow
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Top
.head 6 -  Visible? Yes
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Yes
.head 6 -  Docking Toolbar? Yes
.head 6 -  Toolbar Docking Orientation: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Resizable? Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Destroy
.head 6 -  Call SalSendClassMessageNamed( gwcSqlWindow, SAM_Destroy, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Destroy, 0, 0 )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalSendMsg( hWndItem, SAM_DoubleClick, 0, 0 )
.head 5 +  On PM_SetFont
.head 6 -  ! Параметры отображения
.head 6 -  Call SalColorSet( hWndForm, COLOR_IndexWindowText, nCOLOR_FONT)
.head 6 -  Call SalFontSet( hWndForm, strFONT, nFONT_SIZE, nFONT_ENH )
.head 6 -  ! Call SalSendMsgToChildren ( mdiMain, PM_SetFont, 0, 0 )
.head 5 +  On PM_COLUMN
.head 6 +  If wParam = 1
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SalModalDialog( dlgEditColumns, hWndForm, hWndItem )
.head 5 +  On WM_KEYUP
.head 6 +  If bNeedSaveLoad
.head 7 +  Select Case wParam
.head 8 +  Case VK_Delete
.head 9 -  Return FALSE
.head 8 +  Case VK_Clear
.head 9 -  Return FALSE
.head 8 +  Case VK_ScrollLock
.head 9 -  Call SalPostMsg( hWndItem, PM_COLUMN, 0, 0 )
.head 9 -  Return TRUE
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessageNamed( gwcAutoSave, SAM_Create, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcFindTable, SAM_Create, 0, 0 )
.head 5 +  ! On SAM_ContextMenu
.head 6 -  Call SalSendClassMessageNamed( gwcSortTable, SAM_ContextMenu, 0, 0 )
.head 6 -  Call SalSendClassMessageNamed( gwcFindTable, SAM_ContextMenu, 0, 0 )
.head 3 +  Vertical Scroll Bar Class: caVerticalScrollBar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  0.267"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.738"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! !
.head 3 -  ! ! Классы вида ca<NAME>   END.
.head 3 -  ! !
.head 3 +  General Window Class: gwcMouseWheel
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On WM_MOUSEWHEEL
.head 6 -  Call SalTblScrollOnWheel( wParam, lParam )
.head 3 +  General Window Class: gwcEditFlag
.head 4 -  Description: 
Using in hWndForm:
------
On AAM_EDITFLAG
	Call fbEnable ( TRUE, pbRefresh )
------
SalQueryFieldEdit		SalSetFieldEdit
VisWinClearAllEditFlags	VisWinGetFlags
VisWinSetFlags		VisWinIsRequiredFieldNull
*
SalDisableAllWins	SalEnableAllWins
------
WF_NoClearEditFlag	WF_Required
WF_EnableWhenNotNull
*
WF_NoDisable		WF_NoEnable
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: fCheckEditFlag
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalQueryFieldEdit( hWndItem )
.head 8 -  ! Call SalSendMsg( SalParentWindow( hWndItem ), AAM_EDITFLAG, 0, 0 )
.head 8 -  Call SalSendMsg( hWndItem, AAM_EDITFLAG, 0, 0 )
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call fCheckEditFlag ( )
.head 5 +  On SAM_AnyEdit
.head 6 -  Call fCheckEditFlag ( )
.head 5 +  On AAM_EDITFLAG
.head 6 -  Call SalSendMsg( SalParentWindow( hWndItem ), AAM_EDITFLAG, 0, 0 )
.head 3 +  General Window Class: gwcSortTable
.head 4 -  Description: Для поддержки сортировки таблиц
.head 4 +  Derived From
.head 5 -  Class: gwcFindTable
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nRowST
.head 5 -  Number: nFlagsST
.head 5 -  Window Handle: hWndColST
.head 5 -  Number: nColIDST
.head 5 -  String: strColST
.head 4 +  Functions
.head 5 +  Function: fSortColumn
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nFlags
.head 7 -  Number: p_nX
.head 7 -  Number: p_nY
.head 6 +  Static Variables
.head 7 -  Number: nLastColumnID
.head 6 +  Local variables
.head 7 -  Number: l_nRow
.head 7 -  Window Handle: l_hWndCol_Left
.head 7 -  Window Handle: l_hWndCol_Right
.head 7 -  Number: l_nFlags
.head 7 -  Number: nColumnID
.head 6 +  Actions
.head 7 +  If p_nFlags & MK_SHIFT
.head 8 -  Return FALSE
.head 7 -  Call SalTblObjectsFromPoint( hWndForm, p_nX-3, p_nY, l_nRow,
l_hWndCol_Left, l_nFlags )
.head 7 -  Call SalTblObjectsFromPoint( hWndForm, p_nX+4, p_nY, l_nRow,
l_hWndCol_Right, l_nFlags )
.head 7 +  If l_nFlags & TBL_YOverColumnHeader
.head 8 +  If l_hWndCol_Left != hWndNULL
.head 9 +  If l_hWndCol_Left = l_hWndCol_Right
.head 10 -  Set nColumnID = SalTblQueryColumnID ( l_hWndCol_Left )
.head 10 -  Call SalTblSetColumnFlags( l_hWndCol_Left, COL_Selected, FALSE )
.head 10 -  Call fSort ( nLastColumnID, nColumnID )
.head 10 -  Set nLastColumnID = nColumnID
.head 9 +  Else
.head 10 +  If p_nFlags & MK_CONTROL
.head 11 -  Call VisTblAutoSizeColumn( hWndForm, hWndNULL )
.head 10 +  Else
.head 11 -  Call VisTblAutoSizeColumn( hWndForm, l_hWndCol_Left )
.head 9 -  Return TRUE
.head 5 +  Function: fSort
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLastColumnID
.head 7 -  Number: nColumnID
.head 6 +  Static Variables
.head 7 -  Number: nOrder
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nColumnID >= 0
.head 8 +  If nLastColumnID != nColumnID
.head 9 -  Set nOrder = TBL_SortIncreasing
.head 8 -  Call fWaitCursor( TRUE )
.head 8 -  Call SalStatusSetText( hWndMDI,  fsTranslateText ( 'Сортировка' ) )
.head 8 -  Call SalTblSortRows( hWndForm, nColumnID, nOrder )
.head 8 -  Call SalTblClearSelection( hWndForm )
.head 8 -  Call SalStatusSetText( hWndMDI,  '' )
.head 8 -  Call fWaitCursor( FALSE )
.head 8 +  If nOrder = TBL_SortIncreasing
.head 9 -  Set nOrder = TBL_SortDecreasing
.head 8 +  Else
.head 9 -  Set nOrder = TBL_SortIncreasing
.head 5 +  ! Function: fbDoReport
.head 6 -  Description: this function demonstrates the use of the SalReportTablex
 functions which allow a programmer to produce a report quickly
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nErr
.head 6 +  Actions
.head 7 -  Set nErr = 1
.head 7 +  If SalReportTableCreate('quikrept.qrp', hWndItem, nErr)
.head 8 -  !
.head 8 -  ! This shows the code (commented out) for calling the
  print function and the parameter array, set to print
  all pages and 1 copy.  We use the view function to
  allow more flexibility for the sample application.
.head 8 -  !
.head 8 -  ! Set nRptParams[RPT_PrintParamOptions] = RPT_PrintAll
.head 8 -  ! Set nRptParams[RPT_PrintParamFirstPage] = 1
.head 8 -  ! Set nRptParams[RPT_PrintParamLastPage] = 100
.head 8 -  ! Set nRptParams[RPT_PrintParamCopies] = 1
.head 8 -  ! Call SalReportTablePrint(hWndForm, 'quikrept.qrp', nRptParams, nErr)
.head 8 -  !
.head 8 -  ! Use View for user ease in this sample
.head 8 -  !
.head 8 -  Set nErr = 1
.head 8 -  Call SalReportTableView(hWndItem, hWndNULL, 'quikrept.qrp', nErr)
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 +  Select Case nErr
.head 9 +  Case RPT_ErrBind
.head 10 -  Call SalMessageBox( "A bind error occurred.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrCount
.head 10 -  Call SalMessageBox( "A report function provided the wrong number of bind/input variables.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrFilenameLength
.head 10 -  Call SalMessageBox( "The specified report file name was too long.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrFileOpen
.head 10 -  Call SalMessageBox( "A report function was unable to open the specified report file.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrInput
.head 10 -  Call SalMessageBox( "A mismatch occurred between the input variable and the associated bind variable.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrLoadDLL
.head 10 -  Call SalMessageBox("A report function was unable to load the required DLLs.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrMaxRpts
.head 10 -  Call SalMessageBox("The maximum number of reports was exceeded.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrPrtOpen
.head 10 -  Call SalMessageBox( "A report function was unable to open the printer.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrRptOpen
.head 10 -  Call SalMessageBox( "A report function was unable to open the specified report for printing.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Case RPT_ErrRptWindow
.head 10 -  Call SalMessageBox("A report function was unable to open the report window.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 9 +  Default
.head 10 -  Call SalMessageBox("An unknown error occurred.", "Error Creating Report", MB_Ok | MB_IconExclamation )
.head 10 -  Break
.head 8 -  Return FALSE
.head 4 +  Message Actions
.head 5 +  On WM_LBUTTONDBLCLK
.head 6 +  If fSortColumn( wParam, SalNumberLow( lParam ), SalNumberHigh( lParam ) )
.head 7 -  Return 0
.head 5 +  On SAM_ContextMenu
.head 6 -  Return SalSendClassMessage ( SAM_ContextMenu, wParam, lParam )
.head 6 +  ! If SalSendClassMessage ( SAM_ContextMenu, wParam, lParam ) = 0
.head 7 -  Call SalTblContextMenu(hWndForm, wParam, lParam )
.head 6 -  ! Call SalTblContextMenu(hWndForm, wParam, lParam )
.head 5 +  On SAM_CornerClick
.head 6 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) > 0
.head 7 -  Call SalTblClearSelection ( hWndForm )
.head 6 +  Else
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndForm, ROW_Selected, TRUE, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, SAM_Click, 0, 0 )
.head 6 -  Call SalTblKillFocus( hWndForm )
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalSendMsg( hWndForm, SAM_CornerClick, 0, 0 )
.head 5 +  On AAM_COPY
.head 6 -  Call SalTblCopyRows( hWndForm, ROW_Selected, 0 )
.head 5 +  On WM_COPY
.head 6 -  Call SalTblCopyRows( hWndForm, ROW_Selected, 0 )
.head 5 +  On EM_SETSEL
.head 6 +  If wParam = 0 AND lParam = -1
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndForm, ROW_Selected, TRUE, 0, 0 )
.head 5 +  On WM_PASTE
.head 6 -  Return TRUE
.head 5 +  On WM_CUT
.head 6 -  Return TRUE
.head 5 +  On WM_CLEAR
.head 6 -  Call SalSendMsg( hWndForm, AAM_DELETE, 0, 0 )
.head 6 -  Return TRUE
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 5 +  On VTM_MiddleClick
.head 6 -  Call SalTblObjectsFromPoint( hWndForm, SalNumberLow( lParam ), SalNumberHigh ( lParam ), nRowST, hWndColST, nFlagsST )
.head 6 +  If nRowST = TBL_Error AND  hWndColST != hWndNULL
.head 7 -  Call SalHideWindow( hWndColST )
.head 7 -  Call SalTblSetColumnTitle( hWndColST, '||' || SalTblGetColumnTitleX( hWndColST ) )
.head 6 +  Else
.head 7 -  Set nColIDST = 1
.head 7 +  Loop
.head 8 -  Set hWndColST = SalTblGetColumnWindow ( hWndForm, nColIDST, COL_GetID )
.head 8 +  If hWndColST = hWndNULL
.head 9 -  Break
.head 8 -  Set strColST = SalTblGetColumnTitleX( hWndColST )
.head 8 +  If SalStrLeftX( strColST, 2 ) = '||'
.head 9 -  Call SalStrLop( strColST )
.head 9 -  Call SalStrLop( strColST )
.head 9 -  Call SalTblSetColumnTitle( hWndColST, strColST )
.head 9 -  Call SalShowWindow ( hWndColST )
.head 8 -  Set nColIDST = nColIDST + 1
.head 3 +  General Window Class: gwcAutoSave
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcRegistry
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bNeedSaveLoad
.head 5 -  Boolean: bBlockMax
.head 4 +  Functions
.head 5 +  Function: fSaveWindowSetings
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sWindowName
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  Number: nWidth
.head 7 -  Number: nHight
.head 7 -  Number: nState
.head 6 +  Actions
.head 7 +  If bNeedSaveLoad
.head 8 -  Call SalGetItemName( hWndItem, sWindowName )
.head 8 -  Call SalGetWindowLoc( hWndItem, nX, nY )
.head 8 -  Call SalGetWindowSize( hWndItem, nWidth, nHight )
.head 8 -  Set nState = SalGetWindowState( hWndItem )
.head 8 +  If nState != Window_Minimized
.head 9 -  Call fbSetProfileNumber( sWindowName, "State", nState )
.head 9 +  If nState != Window_Maximized
.head 10 -  Call fbSetProfileNumber( sWindowName, "X", nX )
.head 10 -  Call fbSetProfileNumber( sWindowName, "Y", nY )
.head 10 -  Call fbSetProfileNumber( sWindowName, "Width", nWidth )
.head 10 -  Call fbSetProfileNumber( sWindowName, "Hight", nHight )
.head 5 +  Function: fLoadWindowSetings
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sWindowName
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  Number: nWidth
.head 7 -  Number: nHight
.head 7 -  Number: nState
.head 7 -  Number: nType
.head 7 -  !
.head 6 +  Actions
.head 7 +  If bNeedSaveLoad
.head 8 -  Set nType = SalGetType( hWndItem )
.head 8 +  If nType != TYPE_ChildTable
.head 9 -  Call SalGetItemName( hWndItem, sWindowName )
.head 9 -  Call fbGetProfileNumber( sWindowName, "X", 0, nX )
.head 9 -  Call fbGetProfileNumber( sWindowName, "Y", 0,nY )
.head 9 -  Call fbGetProfileNumber( sWindowName, "Width", 0, nWidth )
.head 9 -  Call fbGetProfileNumber( sWindowName, "Hight", 0, nHight )
.head 9 -  Call fbGetProfileNumber( sWindowName, "State", 0, nState )
.head 9 -  ! Устанавливаем положение и размер.
Есно имя окна не устанавливается
.head 9 -  Call SalSetWindowLoc( hWndItem, nX, nY )
.head 9 +  If nWidth>0 and  nHight>0
.head 10 -  Call SalSetWindowSize( hWndItem, nWidth, nHight )
.head 9 +  If nState = Window_Maximized
.head 10 -  Call VisWinShow( hWndItem,  SHOW_Maximized )
.head 10 +  If NOT bBlockMax
.head 11 -  Call ShowWindow ( GetParent ( hWndItem ), SW_SHOWMAXIMIZED )
.head 9 +  Else
.head 10 -  Call VisWinShow( hWndItem,  SHOW_Normal )
.head 5 +  Function: fSaveWidth
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNameForm
.head 7 -  String: sNameTable
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nColID
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nWidth
.head 7 -  String: sWidths
.head 7 -  Number: nPos
.head 7 -  String: sPos
.head 7 -  String: sSelected
.head 7 -  ! String: sVisible
.head 7 -  String: sTab
.head 7 -  Number: nTableFillType
.head 7 -  Number: nFONT_SIZE0
.head 7 -  String: strFONT0
.head 7 -  Number: nFONT_ENH0
.head 7 -  Number: nCOLOR_FONT0
.head 6 +  Actions
.head 7 -  Set nColID = 1
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow ( hWndItem, nColID, COL_GetID )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Break
.head 8 -  Call SalTblQueryColumnWidth ( hWndCol, nWidth )
.head 8 -  Set sWidths = sWidths || SalNumberToStrX( nWidth, 3 ) || ' '
.head 8 -  Set nPos = SalTblQueryColumnPos ( hWndCol )
.head 8 -  Set sPos = sPos || SalNumberToStrX( nPos, 0 ) || ' '
.head 8 +  If SalTblQueryColumnFlags ( hWndCol, COL_IndicateOverflow )
.head 9 -  Set sSelected = sSelected || '1 '
.head 8 +  Else
.head 9 -  Set sSelected = sSelected || '0 '
.head 8 +  ! If SalIsWindowVisible( hWndCol )
.head 9 -  Set sVisible = sVisible || '1 '
.head 8 +  ! Else
.head 9 -  Set sVisible = sVisible || '0 '
.head 8 -  Set nColID = nColID + 1
.head 7 -  Set sWidths = SalStrTrimX( sWidths )
.head 7 -  Set sPos = SalStrTrimX( sPos )
.head 7 -  Set sSelected = SalStrTrimX( sSelected )
.head 7 -  !
.head 7 -  If SalFontGet ( hWndItem, strFONT0, nFONT_SIZE0, nFONT_ENH0 )
.head 7 -  Set nCOLOR_FONT0 = SalColorGet ( hWndItem, COLOR_IndexWindowText )
.head 7 -  !
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable, sWidths, sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_POS', sPos, sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_SEL', sSelected, sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_FNT', strFONT0, sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_SIZ', SalNumberToStrX( nFONT_SIZE0, 0 ), sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_ENH', SalNumberToStrX( nFONT_ENH0, 0 ), sApplicationName )
.head 7 -  Call SalSetProfileString( sNameForm, sTab || sNameTable || '_COL', SalNumberToStrX( nCOLOR_FONT0, 0 ), sApplicationName )
.head 7 -  ! Call SalSetProfileString( sNameForm, sTab || sNameTable || '_VIS', sVisible, sApplicationName )
.head 7 -  Call SalSetProfileInt( sNameForm, sTab || sNameTable || '_FILL', nTableFillType, sApplicationName )
.head 7 -  ! Call SalSetProfileString(  sWindowName, 'Window', sWindow, sApplicationName )
.head 5 +  Function: fLoadWidth
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNameForm
.head 7 -  String: sNameTable
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nColID
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nWidth
.head 7 -  String: sWidths
.head 7 -  String: sWidth
.head 7 -  Number: nPosInd
.head 7 -  Number: nPos
.head 7 -  String: sPos
.head 7 -  String: sPos1
.head 7 -  String: sSel
.head 7 -  String: sSel1
.head 7 -  Number: nSel
.head 7 -  String: sTab
.head 7 -  Number: nTableFillType
.head 7 -  Number: anPos [ * ]
.head 7 -  Number: nI
.head 7 -  Number: nJ
.head 7 -  Number: nMax
.head 7 -  Number: nCurMax
.head 7 -  ! String: sVis
.head 7 -  ! String: sVis1
.head 7 -  ! Number: nVis
.head 7 -  Number: nFONT_SIZE0
.head 7 -  String: strFONT0
.head 7 -  Number: nFONT_ENH0
.head 7 -  Number: nCOLOR_FONT0
.head 7 -  String: sFONT_SIZE0
.head 7 -  String: sFONT_ENH0
.head 7 -  String: sCOLOR_FONT0
.head 6 +  Actions
.head 7 -  Set nColID = 1
.head 7 -  Set nTableFillType = SalGetProfileInt ( sNameForm, sTab || sNameTable || '_FILL', TBL_FillAll, sApplicationName)
.head 7 -  Call SalGetProfileString ( sNameForm, sTab || sNameTable, '', sWidths, sApplicationName )
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_POS', '', sPos, sApplicationName )
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_SEL', '', sSel, sApplicationName )
.head 7 -  !
.head 7 -  Set strFONT0 = 'MS Sans Serif'
.head 7 -  Set sFONT_SIZE0 = '8'
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_FNT', '', strFONT0, sApplicationName )
.head 7 +  If strFONT0 = ''
.head 8 -  Set strFONT0 = 'MS Sans Serif'
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_SIZ', '', sFONT_SIZE0, sApplicationName )
.head 7 +  If sFONT_SIZE0 = ''
.head 8 -  Set sFONT_SIZE0 = '8'
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_ENH', '', sFONT_ENH0, sApplicationName )
.head 7 -  Call SalGetProfileString( sNameForm, sTab || sNameTable || '_COL', '', sCOLOR_FONT0, sApplicationName )
.head 7 -  Set nFONT_SIZE0 = SalStrToNumber( sFONT_SIZE0 )
.head 7 -  Set nFONT_ENH0 = SalStrToNumber( sFONT_ENH0 )
.head 7 -  Set nCOLOR_FONT0 = SalStrToNumber( sCOLOR_FONT0 )
.head 7 -  Call SalFontSet ( hWndItem, strFONT0, nFONT_SIZE0, nFONT_ENH0 )
.head 7 -  Call SalColorSet ( hWndItem, COLOR_IndexWindowText, nCOLOR_FONT0 )
.head 7 -  !
.head 7 -  ! Call SalGetProfileString( sNameForm, sTab || sNameTable || '_VIS', '', sVis, sApplicationName )
.head 7 +  If sWidths != ''
.head 8 +  Loop
.head 9 -  Set hWndCol = SalTblGetColumnWindow ( hWndItem, nColID, COL_GetID )
.head 9 +  If hWndCol = hWndNULL
.head 10 -  Break
.head 9 -  Set nPosInd = SalStrScan( sWidths, ' ' )
.head 9 +  If nPosInd > 0
.head 10 -  Set sWidth = SalStrLeftX( sWidths, nPosInd )
.head 10 -  Set sWidths = SalStrRightX( sWidths, SalStrLength( sWidths ) - nPosInd - 1 )
.head 9 +  Else
.head 10 -  Set sWidth = sWidths
.head 10 -  Set sWidths = ''
.head 9 -  Set nWidth = SalStrToNumber( sWidth )
.head 9 +  If nWidth > 0
.head 10 -  Call SalTblSetColumnWidth ( hWndCol, nWidth )
.head 9 -  !
.head 9 -  Set nPosInd = SalStrScan( sPos, ' ' )
.head 9 +  If nPosInd > 0
.head 10 -  Set sPos1 = SalStrLeftX( sPos, nPosInd )
.head 10 -  Set sPos = SalStrRightX( sPos, SalStrLength( sPos ) - nPosInd - 1 )
.head 9 +  Else
.head 10 -  Set sPos1 = sPos
.head 10 -  Set sPos = ''
.head 9 -  Set nPos = SalStrToNumber( sPos1 )
.head 9 +  If nPos > 0
.head 10 -  ! Call SalTblSetColumnPos ( hWndCol, nPos )
.head 10 -  Set anPos [ nColID ] = nPos
.head 10 +  ! If nPos != SalTblQueryColumnPos ( hWndCol )
.head 11 -  If nPos = SalTblQueryColumnPos ( hWndCol )
.head 9 -  !
.head 9 -  Set nPosInd = SalStrScan( sSel, ' ' )
.head 9 +  If nPosInd > 0
.head 10 -  Set sSel1 = SalStrLeftX( sSel, nPosInd )
.head 10 -  Set sSel = SalStrRightX( sSel, SalStrLength( sSel ) - nPosInd - 1 )
.head 9 +  Else
.head 10 -  Set sSel1 = sSel
.head 10 -  Set sSel = ''
.head 9 -  Set nSel = SalStrToNumber( sSel1 )
.head 9 +  If nSel > 0
.head 10 -  Call SalTblSetColumnFlags ( hWndCol, COL_IndicateOverflow, TRUE )
.head 10 -  Call fbShowWindow ( FALSE, hWndCol )
.head 9 -  !
.head 9 -  ! Set nPosInd = SalStrScan( sVis, ' ' )
.head 9 +  ! If nPosInd > 0
.head 10 -  Set sVis1 = SalStrLeftX( sVis, nPosInd )
.head 10 -  Set sVis = SalStrRightX( sVis, SalStrLength( sVis ) - nPosInd - 1 )
.head 9 +  ! Else
.head 10 -  Set sVis1 = sVis
.head 10 -  Set sVis = ''
.head 9 +  ! If sVis1 != ''
.head 10 -  Set nVis = SalStrToNumber( sVis1 )
.head 10 +  If nVis > 0
.head 11 -  ! Call SalTblSetColumnFlags ( hWndCol, COL_IndicateOverflow, TRUE )
.head 11 -  Call fbShowWindow ( FALSE, hWndCol )
.head 9 -  !
.head 9 -  Set nColID = nColID + 1
.head 8 -  !
.head 8 -  ! Set nI = 1
.head 8 -  ! Call SalArrayGetUpperBound( anPos, 1, nMax )
.head 8 +  ! While nI <= nMax
.head 9 -  Set hWndCol = SalTblGetColumnWindow ( hWndItem, nI, COL_GetID )
.head 9 +  If hWndCol = hWndNULL
.head 10 -  Break
.head 9 -  Call SalTblSetColumnPos ( hWndCol, anPos [ nI ] )
.head 9 -  Set nI = nI + 1
.head 8 -  !
.head 8 -  Set nI = 1
.head 8 -  Call SalArrayGetUpperBound( anPos, 1, nMax )
.head 8 -  Set anPos [ nMax + 1 ] = -1
.head 8 +  Loop
.head 9 -  Set nJ = 2
.head 9 -  Set nCurMax = 1
.head 9 +  While nJ <= nMax
.head 10 +  If anPos [ nCurMax ] < anPos [ nJ ]
.head 11 -  Set nCurMax = nJ
.head 10 -  Set nJ = nJ + 1
.head 9 -  Set hWndCol = SalTblGetColumnWindow ( hWndItem, nCurMax, COL_GetID )
.head 9 +  If hWndCol = hWndNULL
.head 10 -  Break
.head 9 -  Call SalTblSetColumnPos ( hWndCol, anPos [ nCurMax ] )
.head 9 -  Set anPos [ nCurMax ] = -1
.head 9 -  Set nI = nI + 1
.head 9 +  If nI > nMax
.head 10 -  Break
.head 5 +  Function: fSaveTbl
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNameForm
.head 7 -  String: sNameTable
.head 7 -  Number: nType
.head 6 +  Actions
.head 7 -  Set nType = SalGetType( hWndItem )
.head 7 +  If nType = TYPE_ChildTable OR nType = TYPE_TableWindow
.head 8 -  Set sNameForm = SalGetItemNameX ( SalParentWindow( hWndItem ) )
.head 8 -  Set sNameTable = SalGetItemNameX ( hWndItem )
.head 8 -  Call fSaveWidth ( sNameForm, sNameTable )
.head 5 +  Function: fLoadTbl
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNameForm
.head 7 -  String: sNameTable
.head 7 -  Number: nType
.head 6 +  Actions
.head 7 -  Set nType = SalGetType( hWndItem )
.head 7 +  If nType = TYPE_ChildTable OR nType = TYPE_TableWindow
.head 8 -  Set sNameForm = SalGetItemNameX ( SalParentWindow( hWndItem ) )
.head 8 -  Set sNameTable = SalGetItemNameX ( hWndItem )
.head 8 -  Call fLoadWidth ( sNameForm, sNameTable )
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If bNeedSaveLoad
.head 7 -  Call fLoadWindowSetings()
.head 6 -  ! Call fLoadTbl ( )
.head 6 -  ! Call SalPostMsg( hWndItem, AAM_LOADTABLE, 0, 0 )
.head 5 +  On SAM_CreateComplete
.head 6 -  ! Call fLoadWindowSetings()
.head 6 +  If bNeedSaveLoad
.head 7 -  Call fLoadTbl ( )
.head 5 +  ! On AAM_LOADTABLE
.head 6 -  Call fLoadTbl ( )
.head 5 +  On SAM_Destroy
.head 6 +  If bNeedSaveLoad
.head 7 -  Call fSaveTbl ( )
.head 5 +  On SAM_Close
.head 6 +  If bNeedSaveLoad
.head 7 -  Call fSaveWindowSetings()
.head 3 +  General Window Class: gwcConvertChar
.head 4 -  Description: Преобразование при вводе
точка -> запятая
или наоборот
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Boolean: bConvert
.head 5 -  Boolean: bConvertType
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: fSetConvert
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bConvertPar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bConvert = bConvertPar
.head 5 +  Function: fbGetConvert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bConvert
.head 5 +  Function: fSetConvertType
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bConvertTypePar
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bConvertType = bConvertTypePar
.head 5 +  Function: fbGetConvertType
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bConvertType
.head 4 +  Message Actions
.head 5 +  On WM_CHAR
.head 6 +  If bConvert
.head 7 +  If bConvertType
.head 8 +  If wParam = 0x2E ! "."
.head 9 -  Return SalSendMsg( hWndItem, WM_CHAR, 0x2C, lParam ) ! ","
.head 7 +  Else
.head 8 +  If wParam = 0x2C ! ","
.head 9 -  Return SalSendMsg( hWndItem, WM_CHAR, 0x2E, lParam ) ! "."
.head 3 +  General Window Class: gwcSqlWindow
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 -  On SAM_Destroy
.head 3 +  General Window Class: gwcDisable
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On WM_ENABLE
.head 6 -  Return 0
.head 3 +  Functional Class: fcTooltip
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTooltip
.head 5 -  Window Handle: hWndTooltip
.head 5 -  Number: nStyleTooltip
.head 5 -  Number: nFlagsTooltip
.head 4 +  Functions
.head 5 +  Function: fhWndCreateTooltip
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  String: m_sTooltip
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If m_sTooltip != ''
.head 8 -  Set nStyleTooltip = TTS_ALWAYSTIP
.head 8 -  Set nFlagsTooltip = TTF_SUBCLASS | TTF_IDISHWND
.head 8 -  Set hWndTooltip =  fhWndCreateTooltipWindow ( hWnd,
m_sTooltip, nStyleTooltip,  nFlagsTooltip )
.head 8 -  Call SalSendMsg( hWndTooltip, TTM_SETMAXTIPWIDTH, 0, 300)
.head 5 +  Function: fCreateTooltip
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: m_sTooltip
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTooltip = m_sTooltip
.head 7 +  If sTooltip != ''
.head 8 -  Set nStyleTooltip = TTS_ALWAYSTIP
.head 8 -  Set nFlagsTooltip = TTF_SUBCLASS | TTF_IDISHWND
.head 8 -  Set hWndTooltip =  fhWndCreateTooltipWindow ( hWndItem, sTooltip, nStyleTooltip,  nFlagsTooltip )
.head 8 -  Call SalSendMsg( hWndTooltip, TTM_SETMAXTIPWIDTH, 0, 300)
.head 5 +  Function: fSetTooltipText
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: m_sTooltip
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If sTooltip != m_sTooltip
.head 8 -  Set sTooltip = m_sTooltip
.head 8 -  Call fUpdateTooltipText ( hWndItem, hWndTooltip, sTooltip, nStyleTooltip,  nFlagsTooltip )
.head 5 +  Function: fsGetTooltipText
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sTooltip
.head 5 +  Function: fhWndCreateTooltipWindow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTool
.head 7 -  String: sStringTooltip
.head 7 -  Number: nStyleTooltip
.head 7 -  Number: nFlags
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sBuffer
.head 7 -  Number: nAddr
.head 7 -  Number: nAddrStringReturn
.head 7 -  Number: nReturn
.head 7 -  Window Handle: hTooltip
.head 6 +  Actions
.head 7 -  Set hTooltip = CreateWindowExA( 0, "tooltips_class32", "", nStyleTooltip , CW_USEDEFAULT,CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, hWndForm, 0x0000, GetWindowLongA( hWndForm, GWL_HINSTANCE ), 0)
.head 7 -  Set nAddr = CStructAllocFarMem( 44 )
.head 7 -  Call SalStrSetBufferLength( sBuffer, 44 )
.head 7 -  Call CStructPutInt( sBuffer, 0, 44 )
.head 7 -  Call CStructPutInt( sBuffer, 4, nFlags  )
.head 7 -  Call CStructPutLong( sBuffer, 8, SalWindowHandleToNumber( hWndTool ) )
.head 7 -  Call CStructPutLong( sBuffer, 12,  SalWindowHandleToNumber( hWndTool ) )
.head 7 +  If sStringTooltip != ""
.head 8 -  Set nAddrStringReturn = CStructPutStringCustom( sBuffer, 36, sStringTooltip )
.head 7 +  Else
.head 8 -  Call CStructPutLong( sBuffer, 36,  LPSTR_TEXTCALLBACK )
.head 7 -  Call CStructCopyToFarMem( nAddr, sBuffer, 44 )
.head 7 -  Call SalSendMsg( hTooltip, TTM_ADDTOOL, 0,nAddr)
.head 7 -  Call CStructFreeFarMem( nAddrStringReturn )
.head 7 -  Call CStructFreeFarMem( nAddr )
.head 7 -  Call SalSendMsg(hTooltip, TTM_SETDELAYTIME, TTDT_INITIAL, 500)
.head 7 -  Return hTooltip
.head 5 +  Function: fUpdateTooltipText
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTool
.head 7 -  Window Handle: hTooltip
.head 7 -  String: sStringTooltip
.head 7 -  Number: nStyleTooltip
.head 7 -  Number: nFlags
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sBuffer
.head 7 -  Number: nAddr
.head 7 -  Number: nAddrStringReturn
.head 7 -  Number: nReturn
.head 6 +  Actions
.head 7 -  Set nAddr = CStructAllocFarMem( 44 )
.head 7 -  Call SalStrSetBufferLength( sBuffer, 44 )
.head 7 -  Call CStructPutInt( sBuffer, 0, 44 )
.head 7 -  Call CStructPutInt( sBuffer, 4, nFlags  )
.head 7 -  Call CStructPutLong( sBuffer, 8, SalWindowHandleToNumber( hWndTool ) )
.head 7 -  Call CStructPutLong( sBuffer, 12,  SalWindowHandleToNumber( hWndTool ) )
.head 7 +  If sStringTooltip != ""
.head 8 -  Set nAddrStringReturn = CStructPutStringCustom( sBuffer, 36, sStringTooltip )
.head 7 +  Else
.head 8 -  Call CStructPutLong( sBuffer, 36,  LPSTR_TEXTCALLBACK )
.head 7 -  Call CStructCopyToFarMem( nAddr, sBuffer, 44 )
.head 7 -  Call SalSendMsg( hTooltip, TTM_UPDATETIPTEXT, 0,nAddr)
.head 7 -  Call CStructFreeFarMem( nAddrStringReturn )
.head 7 -  Call CStructFreeFarMem( nAddr )
.head 3 +  General Window Class: gwcStatusBar
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sStatusText
.head 4 +  Functions
.head 5 +  Function: fStatusSetText
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sText
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sStatusText = sText
.head 5 +  Function: fShowStatus
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sStatusTextOld
.head 6 +  Actions
.head 7 +  If hWndMDI != hWndNULL ! AND sStatusText != ''
.head 8 -  Call SalStrSetBufferLength( sStatusTextOld, 255 )
.head 8 +  If SalStatusGetText ( hWndMDI, sStatusTextOld, 255 ) > 0
.head 9 -  Set sStatusTextOld = ''
.head 8 +  If sStatusText != sStatusTextOld
.head 9 -  Call SalStatusSetText( hWndMDI, sStatusText )
.head 4 +  Message Actions
.head 5 +  ! On WM_SETCURSOR
.head 6 -  Call fShowStatus ( )
.head 5 +  On WM_MOUSEMOVE
.head 6 -  Call fShowStatus ( )
.head 3 +  Functional Class: fcRegistry
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  String: sApplicationName
.head 5 -  String: sCompanyName
.head 5 -  Boolean: bUseRegistry
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: fInitRegistry
.head 6 -  Description: Инициализация файла настроек или registry
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bUseRegistryP
.head 7 -  String: sApplicationNameP
.head 7 -  String: sCompanyNameP
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sDrive
.head 7 -  String: sDir
.head 7 -  String: sFile
.head 7 -  String: sExt
.head 6 +  Actions
.head 7 -  !
.head 7 +  If sApplicationNameP = ''
.head 8 -  Set sApplicationNameP = APPLICATION_NAME
.head 7 +  If sCompanyNameP = ''
.head 8 -  Set sCompanyNameP = COMPANY_NAME
.head 7 -  !
.head 7 -  Set bUseRegistry = bUseRegistryP
.head 7 -  Set sCompanyName =sCompanyNameP
.head 7 +  If bUseRegistry
.head 8 -  Set sApplicationName = sApplicationNameP
.head 7 +  Else
.head 8 -  Call VisDosSplitPath ( strArgArray[0], sDrive, sDir, sFile, sExt )
.head 8 -  Set sApplicationName = sDrive || sDir || sApplicationNameP || '.ini'
.head 7 -  Call SalUseRegistry( bUseRegistry, sCompanyName )
.head 5 +  Function: fbSetProfileNumber
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sSection
.head 7 -  String: sEntry
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SalSetProfileString( sSection, sEntry, SalNumberToStrX( nValue, 4 ), sApplicationName )
.head 5 +  Function: fbGetProfileNumber
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sSection
.head 7 -  String: sEntry
.head 7 -  Number: nDefault
.head 7 -  Receive Number: nValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOK
.head 7 -  String: sValue
.head 6 +  Actions
.head 7 -  Set bOK =  SalGetProfileString( sSection, sEntry, "",sValue, sApplicationName )
.head 7 +  If bOK and sValue != ""
.head 8 -  Set nValue = SalStrToNumber( sValue )
.head 7 +  Else
.head 8 -  Set nValue=nDefault
.head 7 -  Return bOK
.head 5 +  Function: fnLoadGlobalNumber
.head 6 -  Description: Восстановить глобальный элемент
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sItemName
.head 7 -  Number: nDefault
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nValue
.head 6 +  Actions
.head 7 -  ! Call SalGetProfileString(  'Global', sItemName, sDefault, sReturn, sApplicationName )
.head 7 -  Set nValue = SalGetProfileInt ( 'Global', sItemName, nDefault, sApplicationName)
.head 7 -  Return nValue
.head 5 +  Function: fSaveGlobalNumber
.head 6 -  Description: Сохранить глобальный элемент
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sItemName
.head 7 -  Number: nValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalSetProfileInt(  'Global', sItemName, nValue, sApplicationName )
.head 7 -  ! Call SalSetProfileString(  'Global', sItemName, SalNumberToStrX( nValue, 4 ), sApplicationName )
.head 5 +  Function: fSaveGlobal
.head 6 -  Description: Сохранить глобальный элемент
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sItemName
.head 7 -  String: sValue
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalSetProfileString(  'Global', sItemName, sValue, sApplicationName )
.head 5 +  Function: fsLoadGlobal
.head 6 -  Description: Восстановить глобальный элемент
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sItemName
.head 7 -  String: sDefault
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sReturn
.head 6 +  Actions
.head 7 -  Call SalGetProfileString(  'Global', sItemName, sDefault, sReturn, sApplicationName )
.head 7 -  Return sReturn
.head 3 +  General Window Class: gwcSizeDialog
.head 4 -  Description: Sizing, maximizing and restoring
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Boolean: bSizeDialog
.head 4 +  Instance Variables
.head 5 -  Boolean: bZoom
.head 4 +  Functions
.head 5 +  Function: fResize
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLeft
.head 7 -  Number: nTop
.head 7 -  Number: nRight
.head 7 -  Number: nBottom
.head 7 -  FunctionalVar: SizeChildren
.head 8 -  Class: cSizeChildren
.head 6 +  Actions
.head 7 -  ! Get the inside dimension of the tab frame
.head 7 -  Call GetClientRect( hWndForm, nLeft, nTop, nRight, nBottom )
.head 7 -  ! Include a margin between the tab edge and fields
.head 7 -  ! Set nRight = SalPixelsToFormUnits ( tblData, nRight + 3, FALSE )
.head 7 -  ! Set nBottom = SalPixelsToFormUnits ( tblData, nBottom + 3, TRUE )
.head 7 -  ! Resize the fields
.head 7 -  ! Call SizeChildren.ExtendChildSize( tblData, nRight, nBottom  )
.head 5 +  Function: HitTest
.head 6 -  Description: HitTest -  Checks the mouse position given and returns a
	hit test value if the cursor is on the border
	( like WM_NCHITTEST for a sizable window )

HT* = HitTest( nCursorPos )
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: pnMousePos
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  Number: nTop
.head 7 -  Number: nLeft
.head 7 -  Number: nRight
.head 7 -  Number: nBottom
.head 7 -  Number: nReturn
.head 7 -  Number: nDlgBrdWidth
.head 7 -  Number: nDlgBrdHeight
.head 7 -  Number: nCaptionHeight
.head 6 +  Actions
.head 7 -  Set nY = SalNumberHigh( pnMousePos )
.head 7 -  Set nX = SalNumberLow( pnMousePos )
.head 7 -  !
.head 7 -  Set nCaptionHeight = GetSystemMetrics( SM_CYCAPTION )
.head 7 -  Set nDlgBrdHeight = GetSystemMetrics( SM_CYFRAME )
.head 7 -  Set nDlgBrdWidth = GetSystemMetrics( SM_CXFRAME )
.head 7 -  !
.head 7 -  Call GetWindowRect( hWndForm, nLeft, nTop, nRight, nBottom )
.head 7 -  !
.head 7 +  If ( ( nY >= nTop AND nY <= nTop + nDlgBrdHeight ) AND
( nX >= nLeft AND nX <= nLeft + nCaptionHeight + nDlgBrdWidth ) ) OR
( ( nY >= nTop AND nY <= nTop + nCaptionHeight + nDlgBrdHeight ) AND
( nX >= nLeft AND nX <= nLeft + nDlgBrdWidth ) )
.head 8 -  Set nReturn = HTTOPLEFT
.head 7 +  Else If ( ( nY >= nTop AND nY <= nTop + nDlgBrdHeight ) AND
( nX >= nRight - nCaptionHeight - nDlgBrdWidth AND nX <= nRight ) ) OR
( ( nY >= nTop AND nY <= nTop + nCaptionHeight + nDlgBrdHeight ) AND
( nX >= nRight - nDlgBrdWidth  AND nX <= nRight ) )
.head 8 -  Set nReturn = HTTOPRIGHT
.head 7 +  Else If ( ( nY >= nBottom - nDlgBrdHeight AND nY <= nBottom ) AND
( nX >= nLeft AND nX <= nLeft + nCaptionHeight + nDlgBrdWidth ) ) OR
( ( nY >= nBottom  - nCaptionHeight - nDlgBrdHeight AND nY <= nBottom ) AND
( nX >= nLeft AND nX <= nLeft + nDlgBrdWidth ) )
.head 8 -  Set nReturn = HTBOTTOMLEFT
.head 7 +  Else If ( ( nY >= nBottom - nDlgBrdHeight AND nY <= nBottom ) AND
( nX >= nRight - nCaptionHeight - nDlgBrdWidth AND nX <= nRight ) ) OR
( ( nY >= nBottom  - nCaptionHeight - nDlgBrdHeight AND nY <= nBottom ) AND
( nX >= nRight - nDlgBrdWidth  AND nX <= nRight ) )
.head 8 -  Set nReturn = HTBOTTOMRIGHT
.head 7 +  Else If ( nX >= nLeft AND nX <= nLeft + nDlgBrdWidth )
.head 8 -  Set nReturn = HTLEFT
.head 7 +  Else If ( nX >= nRight - nDlgBrdWidth AND nX <= nRight )
.head 8 -  Set nReturn = HTRIGHT
.head 7 +  Else If ( nY >= nTop AND nY <= nTop + nDlgBrdHeight )
.head 8 -  Set nReturn = HTTOP
.head 7 +  Else If ( nY >= nBottom - nDlgBrdHeight AND nY <= nBottom)
.head 8 -  Set nReturn = HTBOTTOM
.head 7 -  !
.head 7 -  Return nReturn
.head 4 +  Message Actions
.head 5 +  On WM_NCCREATE
.head 6 +  If bSizeDialog
.head 7 -  Call SetWindowLongA ( hWndForm, GWL_STYLE, GetWindowLongA (hWndForm, GWL_STYLE ) | WS_BORDER | WS_THICKFRAME | WS_MAXIMIZEBOX )
.head 7 -  Call SetWindowLongA ( hWndForm, GWL_EXSTYLE, GetWindowLongA (hWndForm, GWL_EXSTYLE ) | WS_EX_CLIENTEDGE )
.head 5 +  On WM_NCLBUTTONDOWN
.head 6 +  If bSizeDialog
.head 7 +  If wParam = HTRIGHT or wParam = HTLEFT or wParam = HTTOP or wParam = HTBOTTOM or
wParam = HTTOPRIGHT or wParam = HTTOPLEFT or wParam = HTBOTTOMRIGHT or wParam = HTBOTTOMLEFT
.head 8 -  Call SalSendMsg( hWndForm, WM_SYSCOMMAND, SC_SIZE |
HitTest( lParam ) - ( HTSIZEFIRST - 1 ), lParam )
.head 7 +  If wParam = HTZOOM
.head 8 +  If Not bZoom
.head 9 -  Call SalSendMsg( hWndForm, WM_SYSCOMMAND, SC_MAXIMIZE | HTZOOM - ( HTSIZEFIRST - 1 ), lParam )
.head 9 -  Set bZoom = TRUE
.head 8 +  Else
.head 9 -  Call SalSendMsg( hWndForm, WM_SYSCOMMAND, SC_RESTORE | HTZOOM - ( HTSIZEFIRST - 1 ), lParam )
.head 9 -  Set bZoom = FALSE
.head 5 +  On WM_SIZE
.head 6 +  If bSizeDialog
.head 7 -  Call ..fResize ( )
.head 3 +  Functional Class: cSizeChildren
.head 4 -  Description: Functions used to resize child windows
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: ExtendChildWidth
.head 6 -  Description: Change a window width to extend to a given location
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  Number: nExtendRight
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nWidth
.head 7 -  Number: nHeight
.head 7 -  Number: nTop
.head 7 -  Number: nLeft
.head 6 +  Actions
.head 7 -  Call SalGetWindowLoc( hWnd, nLeft, nTop )
.head 7 -  Call SalGetWindowSize( hWnd, nWidth, nHeight )
.head 7 -  Call SalSetWindowSize( hWnd, nExtendRight - nLeft, nHeight )
.head 5 +  Function: ExtendChildSize
.head 6 -  Description: Change a window size to extend to a given location
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  Number: nExtendRight
.head 7 -  Number: nExtendBottom
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nWidth
.head 7 -  Number: nHeight
.head 7 -  Number: nTop
.head 7 -  Number: nLeft
.head 6 +  Actions
.head 7 -  Call SalGetWindowLoc( hWnd, nLeft, nTop )
.head 7 -  Call SalGetWindowSize( hWnd, nWidth, nHeight )
.head 7 -  Call SalSetWindowSize( hWnd, nExtendRight - nLeft, nExtendBottom - nTop )
.head 3 -  !
.head 3 +  Functional Class: Excel_Export
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: ExportToExcel
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  ! String: strCaption
.head 7 -  String: sFileName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  ! Call xlExport.ExportToExcel( hWndForm, strCaption )
.head 7 -  Call SalModalDialog( dlgExport, hWnd, hWnd, FALSE, sFileName )
.head 7 -  Set gbZap = FALSE
.head 3 -  !
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgExport
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экспорт таблицы
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 5.05"
.head 4 -  Top: 3.563"
.head 4 -  Width:  4.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.012"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: None
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbExport
.data CLASSPROPSSIZE
0000: 4900
.enddata
.data CLASSPROPS
0000: 544F4F4C5449505F 5374617475730012 00CFE5F0E5EDE5F1 F2E820E220457863
0020: 656C0000544F4F4C 5449505F54697000 1200CFE5F0E5EDE5 F1F2E820E2204578
0040: 63656C0000000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.083"
.head 5 -  Top: 0.024"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: save1.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Flat Look
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  ! Call fhWndCreateTooltip ( hWndItem, fsTranslateText ( "Перенести в Excel" ) )
.head 6 -  Set sTip = "Перенести в Excel"
.head 6 -  Set sStatus = "Перенести в Excel"
.head 5 +  On SAM_Click
.head 6 -  Set strOldName = dfFile
.head 6 +  If mlPath != ''
.head 7 -  Set dfFile = mlPath
.head 6 -  ! Set dfFile = VisStrSubstitute ( dfFile, ' ', '_' )
.head 6 -  Set dfFile = VisStrSubstitute ( dfFile, '/', '_' )
.head 6 -  ! Set dfFile = VisStrSubstitute ( dfFile, ':', '_' )
.head 6 -  Set dfFile = VisStrSubstitute ( dfFile, '"', '_' )
.head 6 -  Set gbHTML = cbHTML
.head 6 -  Set gbExcel = cbExcel
.head 6 +  If cbHTML 
.head 7 +  If cbExcel
.head 8 -  Set dfFile = VisStrSubstitute ( dfFile, '.htm', '.xls' )
.head 7 +  Else
.head 8 -  Set dfFile = VisStrSubstitute ( dfFile, '.xls', '.htm' )
.head 6 +  Else
.head 7 -  Set dfFile = VisStrSubstitute ( dfFile, '.htm', '.xls' )
.head 6 +  If cbDate AND bDlg
.head 7 -  ! Set sFile = sFile || ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'dd.MM.yyyy' )
.head 7 -  Set dfFile = VisStrSubstitute ( dfFile, '.htm', ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'dd.MM.yyyy' ) || '.htm' )
.head 7 -  Set dfFile = VisStrSubstitute ( dfFile, '.xls', ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'dd.MM.yyyy' ) || '.xls' )
.head 6 +  If cbMin AND bDlg
.head 7 -  ! Set sFile = sFile || ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'hh.mm' )
.head 7 -  Set dfFile = VisStrSubstitute ( dfFile, '.htm', ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'hhhh-mm' ) || '.htm' )
.head 7 -  Set dfFile = VisStrSubstitute ( dfFile, '.xls', ' ' || SalFmtFormatDateTime( SalDateCurrent(  ), 'hhhh-mm' ) || '.xls' )
.head 6 +  If SalTblCSVExport(phWndTable,dfFile, dfDelimiter, cbDoubleQuote, cbHeader , cbClearString, cbHiddenColumns, cbExcelFormat )
.head 7 +  If cbHTML AND NOT cbExcel
.head 8 -  ! Call SalLoadApp( 'explorer', dfFile )
.head 8 -  Call VisDosSplitPath ( dfFile, sDrive, sDir, sFile, sExt )
.head 8 +  If sDrive = ''
.head 9 -  Call VisDosSplitPath ( strArgArray[0], sDrive, sDir, sFile1, sExt1 )
.head 8 -  Set strPath = sDrive || sDir || sFile || sExt
.head 8 -  Set sFile = 'file://localhost/' || strPath
.head 8 -  Set sFile = VisStrSubstitute ( sFile, '\\', '/' )
.head 8 -  Call SalStrSetBufferLength( sExcelPath, 256 )
.head 8 -  Call FindExecutableA( dfFile, STRING_Null, sExcelPath )
.head 8 -  Call SalLoadApp( sExcelPath, '"' || sFile || '"' )
.head 7 +  Else
.head 8 -  Call SalStrSetBufferLength( sExcelPath, 256 )
.head 8 -  Call FindExecutableA( dfFile, STRING_Null, sExcelPath )
.head 8 -  ! Call SalLoadApp( sExcelPath, dfFile )
.head 8 -  Call SalLoadApp( sExcelPath, '"' || dfFile || '"' )
.head 7 +  If dfFile != 'Export01.xls' OR dfFile != 'Export01.htm' OR strPath != ''
.head 8 -  Set dfFile = VisStrSubstitute ( dfFile, '.htm', '.xls' )
.head 8 -  Call fcRegistryVar.fSaveGlobal ( 'FileName', dfFile )
.head 8 -  Call fcRegistryVar.fSaveGlobal ( 'FilePath', strPath )
.head 7 -  !
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 6 +  Else
.head 7 -  Call SalMessageBox ( 'Невозможно создать файл.
Файл "' || dfFile || '" занят!',
                               'Ошибка', 0 )
.head 7 -  Set dfFile = strOldName
.head 7 -  ! Call SetFocus( dfSum )
.head 3 +  Data Field: dfFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.533"
.head 6 -  Top: 0.738"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  ! Set MyValue = 'Export01.xls'
.head 6 -  ! Set MyValue = fcRegistryVar.fsLoadGlobal ( 'FileName', 'Export01.xls' )
.head 6 -  ! Set strPath = fcRegistryVar.fsLoadGlobal ( 'FilePath', '' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set mlPath = ''
.head 3 +  Pushbutton: pbEK
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 544F4F4C5449505F 5374617475730016 00C2FBE1EEF020EF F3F2E820F1EEF5F0
0020: E0EDE5EDE8FF0000 5461624368696C64 4E616D6573000600 4E616D6535000054
0040: 4F4F4C5449505F54 6970000600CEE1E7 EEF0000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: 5A00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cButton
.head 4 -  Property Template: tt32.exe,dlgToolTipProps,Tooltip...,,N,N
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.083"
.head 5 -  Top: 0.738"
.head 5 -  Width:  0.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: PicFldrOpen.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Gray
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strFilters[0] = 'Книга Microsoft Excel (*.xls)'
.head 6 -  Set strFilters[1] = '*.xls'
.head 6 -  Set strFilters[2] = 'Текстовый файл (*.txt)'
.head 6 -  Set strFilters[3] = '*.txt'
.head 6 -  Set strFilters[4] = 'HTML файл (*.htm)'
.head 6 -  Set strFilters[5] = '*.htm'
.head 6 -  Set strFilters[6] = 'Все файлы (*.*)'
.head 6 -  Set strFilters[7] = '*.*'
.head 6 -  Set strFile = dfFile
.head 6 +  If SalStrScan( dfFile, '\\' ) >= 0
.head 7 -  Call VisDosSplitPath ( dfFile, sDrive, sDir, sFile, sExt )
.head 6 +  Else
.head 7 -  Call VisDosSplitPath ( strArgArray[0], sDrive, sDir, sFile, sExt )
.head 6 -  Set strPath = sDrive || sDir
.head 6 +  If cbHTML
.head 7 -  Set nIndex = 3
.head 6 +  Else
.head 7 -  Set nIndex = 1
.head 6 +  If SalDlgSaveFile ( hWndForm, 'Имя файла для сохранения таблицы', strFilters, 8, nIndex, strFile, strPath )
.head 7 -  Set dfFile = strFile
.head 6 -  Call SalSetFocus( dfFile )
.head 6 -  Set mlPath = strPath
.head 3 -  Group Box: Настройки экспорта в Excel
.head 4 -  Resource Id: 8937
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: caGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left: 0.133"
.head 5 -  Top: 1.631"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.214"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Check Box: cbDoubleQuote
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: В кавычках
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 1.881"
.head 5 -  Width:  1.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 3 +  Check Box: cbHTML
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: в формате HTML
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 1.238"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 5 +  On SAM_Click
.head 6 +  If cbHTML
.head 7 -  Call SalEnableWindow(cbExcel)
.head 6 +  Else
.head 7 +  If cbExcel
.head 8 -  Set cbExcel = FALSE
.head 7 -  Call SalDisableWindow(cbExcel)
.head 3 +  Check Box: cbExcel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: HTML в Excel
.head 4 -  Window Location and Size
.head 5 -  Left: 2.333"
.head 5 -  Top: 1.238"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 3 +  Check Box: cbDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: C датой
.head 4 -  Window Location and Size
.head 5 -  Left: 1.983"
.head 5 -  Top: 0.488"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 3 +  Check Box: cbMin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Минуты
.head 4 -  Window Location and Size
.head 5 -  Left: 3.133"
.head 5 -  Top: 0.488"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 3 +  Check Box: cbHeader
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заголовок
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 2.167"
.head 5 -  Width:  1.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 3 +  Check Box: cbClearString
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пустые строки
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 2.452"
.head 5 -  Width:  1.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbHiddenColumns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Спрятанные колонки
.head 4 -  Window Location and Size
.head 5 -  Left: 2.233"
.head 5 -  Top: 1.881"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbExcelFormat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: В формате Excel
.head 4 -  Window Location and Size
.head 5 -  Left: 2.233"
.head 5 -  Top: 2.167"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Разделитель
.head 4 -  Resource Id: 8936
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.533"
.head 5 -  Top: 2.512"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDelimiter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.783"
.head 6 -  Top: 2.452"
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = '	'
.head 3 +  Multiline Field: mlPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left: 0.733"
.head 6 -  Top: 0.095"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Имя файла
.head 4 -  Resource Id: 8935
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 0.548"
.head 5 -  Width:  1.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbClose
.data CLASSPROPSSIZE
0000: 3500
.enddata
.data CLASSPROPS
0000: 544F4F4C5449505F 5374617475730008 00C7E0EAF0FBF2FC 0000544F4F4C5449
0020: 505F546970000800 C7E0EAF0FBF2FC00 0000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.983"
.head 5 -  Top: 0.024"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: close_.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Flat Look
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  ! Call fhWndCreateTooltip ( hWndItem, fsTranslateText ( "Закрыть" ) )
.head 6 -  Set sTip = "Закрыть"
.head 6 -  Set sStatus = "Закрыть"
.head 5 +  On SAM_Click
.head 6 -  ! Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 +  ! cVPbKeys: pbSelect
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRec = tblList.colCodBank
.head 6 -  Set strName = tblList.colNameBank
.head 6 +  If nRec>0
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 7 -  Return TRUE
.head 5 +  On SAM_Create
.head 6 -  Set sTip = REF_StrSelect
.head 6 -  Set sStatus = "Выбрать текущий банк"
.head 3 -  Group Box:
.head 4 -  Resource Id: 25401
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.133"
.head 5 -  Top: 1.06"
.head 5 -  Width:  4.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.524"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Window Handle: phWndTable
.head 3 -  Boolean: bDlg
.head 3 -  String: sFileName
.head 2 +  Window Variables
.head 3 -  String: sExcelPath
.head 3 -  String: strFilters [*]
.head 3 -  String: sDrive
.head 3 -  String: sDir
.head 3 -  String: sFile
.head 3 -  String: sExt
.head 3 -  String: sFile1
.head 3 -  String: sExt1
.head 3 -  String: strFile
.head 3 -  String: strPath
.head 3 -  Number: nIndex
.head 3 -  Number: nRet
.head 3 -  Number: nFile
.head 3 -  File Handle: hFile
.head 3 -  String: strOldName
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! Call SalSetWindowText( hWndForm, "Перенос таблицы в Excel" )
.head 4 +  If sFileName = ''
.head 5 -  Set dfFile = fcRegistryVar.fsLoadGlobal ( 'FileName', 'Export01.xls' )
.head 5 -  Set strPath = fcRegistryVar.fsLoadGlobal ( 'FilePath', '' )
.head 4 +  Else
.head 5 +  If SalStrScan( SalStrUpperX( sFileName ), '.XLS' ) > 0
.head 6 -  Set dfFile = sFileName
.head 5 +  Else
.head 6 -  Set dfFile = sFileName || '.xls'
.head 5 -  Set strPath = '' 
.head 4 +  If NOT bDlg
.head 5 -  Set nRet = SalMessageBox( "Сохранить данные в файл?",
	     "Сообщение",
	    MB_IconQuestion | MB_YesNoCancel | MB_DefButton2 )
.head 5 +  If nRet = IDYES
.head 6 -  Set bDlg = TRUE
.head 5 +  Else If nRet = IDNO
.head 6 -  Set nFile = 1
.head 6 +  Loop
.head 7 -  Set dfFile =  '~Export' || SalNumberToStrX( nFile, 0 ) || '.xls'
.head 7 -  Set nFile = nFile + 1
.head 7 +  If SalFileOpen( hFile, dfFile, OF_Create | OF_Share_Deny_Write )
.head 8 -  Call SalFileClose ( hFile )
.head 8 -  Break
.head 6 -  Set strPath = ''
.head 6 -  Call SalHideWindow( hWndForm )
.head 5 +  Else
.head 6 -  Call SalHideWindow( hWndForm )
.head 6 -  ! Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 4 -  Set cbHTML = gbHTML
.head 4 -  Set cbExcel = gbExcel
.head 4 +  If cbHTML
.head 5 -  Call SalEnableWindow(cbExcel)
.head 4 +  Else
.head 5 -  Set cbExcel = FALSE
.head 5 -  Set gbExcel = cbExcel
.head 5 -  Call SalDisableWindow(cbExcel)
.head 4 -  Set mlPath = strPath
.head 4 -  Set cbDate = TRUE
.head 3 +  On SAM_CreateComplete
.head 4 +  If NOT bDlg
.head 5 -  Call SalSendMsg( pbExport, SAM_Click, 0, 0 )
.head 4 +  Else
.head 5 -  Call SalSetFocus( dfFile )
